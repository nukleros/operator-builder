
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for Operator Builder">
      
      
        <meta name="author" content="Operator Builder developers">
      
      
      
        <link rel="prev" href="../license/">
      
      
        <link rel="next" href="../contact/">
      
      
      <link rel="icon" href="../images/operator-builder-logo.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.31">
    
    
      
        <title>API Updates & Upgrades - Operator Builder</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-updates-upgrades" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Operator Builder" class="md-header__button md-logo" aria-label="Operator Builder" data-md-component="logo">
      
  <img src="../images/operator-builder-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Operator Builder
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Updates & Upgrades
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/nukleros/operator-builder" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    nukleros/operator-builder
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Operator Builder" class="md-nav__button md-logo" aria-label="Operator Builder" data-md-component="logo">
      
  <img src="../images/operator-builder-logo.png" alt="logo">

    </a>
    Operator Builder
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nukleros/operator-builder" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    nukleros/operator-builder
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Workloads
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Workloads
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workloads/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workloads
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../standalone-workloads/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Standalone Workloads
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workload-collections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workload Collections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workload-collection-tutorial/workload-collection-tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workload Collection Tutorial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../markers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markers
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../resource-scope/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resource Scope
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../companion-cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Companion CLI
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License Management
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API Updates & Upgrades
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API Updates & Upgrades
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#updating-an-existing-api" class="md-nav__link">
    <span class="md-ellipsis">
      Updating an Existing API
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-a-new-version-of-an-api" class="md-nav__link">
    <span class="md-ellipsis">
      Adding a New Version of an API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding a New Version of an API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kubernetes-api-versions" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes API Versions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contact/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contact
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#updating-an-existing-api" class="md-nav__link">
    <span class="md-ellipsis">
      Updating an Existing API
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-a-new-version-of-an-api" class="md-nav__link">
    <span class="md-ellipsis">
      Adding a New Version of an API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding a New Version of an API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kubernetes-api-versions" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes API Versions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="api-updates-upgrades">API Updates &amp; Upgrades<a class="headerlink" href="#api-updates-upgrades" title="Permanent link">&para;</a></h1>
<p>This document deals with two things:
1. Updating an existing API.
2. Adding a new version of an API.</p>
<h2 id="updating-an-existing-api">Updating an Existing API<a class="headerlink" href="#updating-an-existing-api" title="Permanent link">&para;</a></h2>
<p>In this scenario, you are overwriting and changing an existing API specification.
You should only do this during development with an unreleased API that no end user
has started using.</p>
<p>For example, you have begun development on a brand new operator.  You have
generated the source code from a set of YAML manifests with markers.  While
testing, you discover that a field is misspelled, or that a default value should
be changed, or that a new field should be added.  The following instructions
describe how to overwrite an existing API to update the existing spec.  Please 
note that in the below example the <code>--resource=true</code> is not necessary and is 
only provided in the example for verbosity.  This option is set by default.</p>
<p>After making the necessary changes to your manifests run the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>operator-builder<span class="w"> </span>create<span class="w"> </span>api<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--workload-config<span class="w"> </span><span class="o">[</span>path/to/workload/config<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--controller<span class="o">=</span><span class="nb">false</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--resource<span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--force
</code></pre></div></td></tr></table></div>
<p>You will pass the same workload config file.  The <code>--controller=false</code> flag will
skip generating controller code but <code>--resource</code> and <code>--force</code> will cause the
existing API to be overwritten.</p>
<p>Note: if you change any of the following fields in the workload config you will
get a new API rather than overwrite the existing one.
- <code>spec.api.domain</code>
- <code>spec.api.group</code>
- <code>spec.api.version</code>
- <code>spec.api.kind</code></p>
<h2 id="adding-a-new-version-of-an-api">Adding a New Version of an API<a class="headerlink" href="#adding-a-new-version-of-an-api" title="Permanent link">&para;</a></h2>
<p>In this scenario, an existing version of an API is in use by end users.  You
need to add features to the API that require adding, removing or altering
fields.  Do not make breaking changes to an exising API that will render users'
existing custom resource manifests invalid.</p>
<p>Instead, you must add a <em>new</em> API version.  Now, you have two choices:
1. Maintain backward compatibility with previous API version/s.
2. Require an upgrade of API version with a new version of your controller and
   companion CLI.  In this case, ensure your users understand what to expect so
   they don't attempt to use an old API version with a new version of the
   controller.</p>
<h3 id="kubernetes-api-versions">Kubernetes API Versions<a class="headerlink" href="#kubernetes-api-versions" title="Permanent link">&para;</a></h3>
<p>Kubernetes has adopted detailed conventions for changing APIs.  To learn these
details visit <a href="https://kubernetes.io/docs/concepts/overview/kubernetes-api/">The Kubernetes
API</a> and <a href="https://kubernetes.io/docs/reference/using-api/">API
Overview</a> in the Kubernetes
docs.</p>
<p>While you are naturally free to use your own conventions, we encourage you to
model them on the Kubernetes system.  Your users will likely be familiar with
them and those upstream conventions have sound reasoning behind them.</p>
<p>For the purposes of this docuement, here are the important points:
- Do not maintain backward compatibility for alpha API verions.  The development
  cost of conversion between API versions is non-trivial.  Collaborate with the
  early adopters that use your alpha versions and clearly document which
  software versions support which API versions.
- Maintain backward compatibility for beta versions of your APIs for 9 months or
  3 releases (whichever is longer).  Do not release a beta version of your API
  until you are confident few changes will be required in the forseeable future.
- Maintain backward compatibility for stable versions for 12 months or 3
  releases (whichever is longer).  Do not release a stable version until the API
  is well tested and ready for production use.</p>
<p>Following is a table that provides an example of what this may look like.  The
first column shows the release version that applies to the controller and
companion CLI.  The versions for these two components will always be pinned
together - they share source code after all.  Notice that there is only one
major version change.  The 1.0 release coincides with the v1 release of the API
and signifies production readiness.  It does not signify any breaking change
as the API versions have their own compatibility lifecycle.  As such there is no
meaning to a 2.0 release of the controller and CLI.  This would only make sense
if entirely new API groups and types were implemented to break backward
compatibility.</p>
<table>
<thead>
<tr>
<th>Controller, CLI Version</th>
<th>Supported API Versions</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.1</td>
<td>v1alpha1</td>
<td>Initial Release</td>
</tr>
<tr>
<td>0.2</td>
<td>v1alpha2</td>
<td>v1alpha1 support removed</td>
</tr>
<tr>
<td>0.3</td>
<td>v1alpha3</td>
<td>v1alpha2 support removed</td>
</tr>
<tr>
<td>0.4</td>
<td>v1beta1</td>
<td>v1alpha3 support removed</td>
</tr>
<tr>
<td>0.5</td>
<td>v1beta2, v1beta1</td>
<td>v1beta1 deprecated</td>
</tr>
<tr>
<td>0.6</td>
<td>v1beta2, v1beta1</td>
<td>No change in API, software features added</td>
</tr>
<tr>
<td>1.0</td>
<td>v1, v1beta2</td>
<td>v1beta1 support removed, v1beta2 deprecated</td>
</tr>
<tr>
<td>1.1</td>
<td>v2alpha1, v1</td>
<td></td>
</tr>
<tr>
<td>1.2</td>
<td>v2alpha2, v1</td>
<td>v1beta2 and v2alpha1 support removed</td>
</tr>
<tr>
<td>1.3</td>
<td>v2beta1, v1</td>
<td>v2alpha2 support removed</td>
</tr>
<tr>
<td>1.4</td>
<td>v2beta2, v2beta1, v1</td>
<td>v2beta1 deprecated</td>
</tr>
<tr>
<td>1.5</td>
<td>v2, v2beta2, v2beta1, v1</td>
<td>v2beta2 and v1 deprecated</td>
</tr>
<tr>
<td>1.6</td>
<td>v2, v2beta2, v1</td>
<td>v2beta1 support removed</td>
</tr>
<tr>
<td>1.7</td>
<td>v2, v1</td>
<td>v2beta2 support removed</td>
</tr>
<tr>
<td>1.8</td>
<td>v2</td>
<td>v1 support removed</td>
</tr>
</tbody>
</table>
<p>Note there there is no change in supported API versions with version 0.6.  The
convention of increasing minor version when software features are added remains.
Any time an API version is added or removed, a new minor version should be
released, however an API change is not <em>needed</em> to justify a new minor version of
the software when other features not related to an API are released.</p>
<p>To create a new version of an existing API, update the <code>spec.api.version</code> value
in your workload config, for example:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webstore</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">StandaloneWorkload</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">api</span><span class="p">:</span>
<span class="w">    </span><span class="nt">domain</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">acme.com</span>
<span class="w">    </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps</span>
<span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1alpha2</span><span class="w">  </span><span class="c1"># existing API version is v1alapha1</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WebStore</span>
<span class="w">    </span><span class="nt">clusterScoped</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">companionCliRootcmd</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webstorectl</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Manage the webstore app</span>
<span class="w">  </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app.yaml</span>
</code></pre></div></td></tr></table></div>
<p>Now reference the config in a new <code>create api</code> command:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>operator-builder<span class="w"> </span>create<span class="w"> </span>api<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--workload-config<span class="w"> </span><span class="o">[</span>path/to/workload/config<span class="o">]</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--controller<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--resource<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--force
</code></pre></div></td></tr></table></div>
<p>Note that we <em>do</em> want to re-generate the controller in this case.
A new API definition will be create alongside the previous version.  If the
earlier version of the API is to be unsupported, you can delete the earlier
version.</p>
<p>For example if your APIs look as follows:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code>tree<span class="w"> </span>apis/apps
apis/apps
├──<span class="w"> </span>v1alpha1
│<span class="w">   </span>├──<span class="w"> </span>groupversion_info.go
│<span class="w">   </span>├──<span class="w"> </span>webstore
│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>app.go
│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>resources.go
│<span class="w">   </span>├──<span class="w"> </span>webstore_types.go
│<span class="w">   </span>└──<span class="w"> </span>zz_generated.deepcopy.go
└──<span class="w"> </span>v1alpha2
<span class="w">    </span>├──<span class="w"> </span>groupversion_info.go
<span class="w">    </span>├──<span class="w"> </span>webstore
<span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span>app.go
<span class="w">    </span>│<span class="w">   </span>└──<span class="w"> </span>resources.go
<span class="w">    </span>├──<span class="w"> </span>webstore_types.go
<span class="w">    </span>└──<span class="w"> </span>zz_generated.deepcopy.go

<span class="m">4</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">10</span><span class="w"> </span>files
</code></pre></div></td></tr></table></div>
<p>You will delete the earlier version with <code>rm -rf apis/apps/v1alpha1</code>.</p>
<p>If, however, you want to retain backward compatibility and support both versions
you will need to implement conversion between the APIs.  Operator Builder does
not yet support any scaffolding or code generation for this.  For details on how
to accomplish this, refer to the <a href="https://kubebuilder.io/multiversion-tutorial/conversion.html">Kubebuilder
docs</a> on API
conversion.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022-2024 Operator Builder
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/threeport/threeport" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>